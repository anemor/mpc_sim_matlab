# Mathematical Modeling and Model-Based Predictive Control for Vertical Take-Off and Landing of Rockets
This repository includes the software and figures developed for my thesis on developing a Nonlinear MPC for controlling a rocket hopper. The code is written in Matlab, and uses CasADi to formulate and solve the NLP. The main simulations can be found in the main_ files.


# Abstract
This thesis investigates guidance and control systems for a Vertical Take-Off and Landing (VTOL) vehicle, with a focus on Model Predictive Control (MPC) frameworks tailored for a take-off, hover and landing scenarios of a rocket hopper. The research was conducted in collaboration with Propulse NTNU, a voluntary student organization at the Norwegian University of Science and Technology (NTNU) that is dedicated to developing sounding rockets and rocket propulsion systems. Propulse NTNU’s first bi-propellant liquid rocket, Bifrost, was launched in October 2023, marking a significant achievement as Norway’s first bi-liquid rocket and the most powerful student-built bi-liquid rocket in Europe. This success has propelled the team's ambition to explore the use of Thrust Vector Control (TVC) to enhance maneuverability and precise control during flight of upcoming projects, in addition to exploring reusable rocket technology.

This thesis explore and implement optimal control methods for a VTOL vehicle, focusing on Nonlinear MPC for various flight scenarios. A quaternion-based mathematical model was formulated and implemented using Matlab, and subsequently verified through simulations with different initial conditions and predefined control signals. Furthermore, the rocket hopper was formulated as a constrained optimization problem, which was implemented and solved using the CasADi software package. This Nonlinear MC controller was then validated through simulations of various scenarios, aiming to reach a desired setpoint. A Finite State Machine-based logic was formulated and implemented to manage different phases of flight and determine setpoints.

The results from the simulations of this hopper indicate that the controlled system is capable of achieving precise control, both while hovering and landing. However, some limitations were found in situations with unmodeled disturbances and large differences to the next setpoint. This suggests that a formulation with integral action in state estimates, as well as a stabilizing LQR-based terminal cost could improve the hopper's ability to reach desired values. Additionally, more energy-efficient methods were proposed to achieve smoother reference values. To investigate the suitability of the formulated control module for physical experiments, the selection of optimal control signals and the controller's computation time were examined, which requires further work and physical testing with actuators for improvement. Overall, the findings of this thesis provide a solid foundation for the future research and implementation of upgrades to the MPC and guidance systems for the hopper, in order to achieve a more robust, efficient, and reliable performance in physical experiments.
